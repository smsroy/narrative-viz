<!DOCTYPE html>
<html lang="en-us">
<script src='https://d3js.org/d3.v5.min.js'></script>
  <head>
    <meta charset="UTF-8">
    <title>Narrative-viz by smsroy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:200,500' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
	<link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
	<link rel="stylesheet" type="text/css" href="stylesheets/custom.css" media="screen">
  </head> 
 
  <body onload='init()'>
    <section class="page-header">
      <h1 class="project-name">Data Engineer Jobs Visualization</h1>
    </section>

    <section class="main-content">
      <h3>
	<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>
	<p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here <a href="https://guides.github.com/features/mastering-markdown/">using GitHub Flavored Markdown</a>, select a template crafted by a designer, and publish. After your page is generated, you can check out the new <code>gh-pages</code> branch locally. If you’re using GitHub Desktop, simply sync your repository and you’ll see the new branch.</p>
	
	
	<div>
	<svg width=600 height=500>
	</svg>
	</div>
	
	
	<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>
	<p>Having trouble with Pages? Check out our <a href="https://help.github.com/pages">documentation</a> or <a href="https://github.com/contact">contact support</a> and we’ll help you sort it out.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/smsroy/narrative-viz">Narrative-viz</a> is maintained by <a href="https://github.com/smsroy">smsroy</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>
  
	<script>
	async function init() {	
		var margin = {top: 50, right: 50, bottom: 50, left: 50};
		var width = 600;
		var height = 600;
		var xwidth = width - 2*margin.right - 2*margin.left;
		var yheight = height - 2*margin.top - 2*margin.bottom;
		
		const data = await d3.csv("data/DataEngineer1.csv");

		var data1 = d3.nest()
		.key(function(d) { return (d.JobTitle == '')? 'None' : d.JobTitle;})
		.rollup(function(d) { 
			return d3.sum(d, function(g) {return 1; });
		})
		.entries(data);
		
		data1.sort(function(a,b) {
			return d3.descending(+a.value, +b.value);
		});
		var graphdata = data1.slice(0, 20);	 // Top 20 elements	
		console.log(graphdata);	
		
		var xs = d3.scaleBand()
		.domain(graphdata
		.map(function(d) { return d.key; }))
		.range([0,xwidth]);
		
		var ys = d3.scaleLinear()
		.domain([d3.min(graphdata, function(d) { return d.value; }), d3.max(graphdata, function(d) { return d.value; })])
		.range([yheight, 0]);		

		d3.select("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("transform", "translate("+ margin.right + "," + margin.bottom + ")")
		.selectAll("rect")
		.data(graphdata)
		.enter().append("rect")
		.attr("x",function(d,i) { return xs(d.key); })
		.attr("y",function(d) { return ys(d.value); })
		.attr("width", xs.bandwidth())
		.attr("height",function(d) { return yheight - ys(d.value); })
		.text(d => d.value)
                        .on("mouseover", d => {tooltip.text(d.key + " : " + (d.value).toFixed(0)); return tooltip.style("visibility", "visible")})
                        .on("mousemove", function(){return tooltip.style("top", (d3.event.pageY-10)+"px").style("left",(d3.event.pageX+10)+"px");})
						.on("mouseout", () => tooltip.style("visibility", "hidden"));
						
		var tooltip = d3.select("body")
		.append("div")
		.attr("class", "tooltip")
		.style("position", "absolute")
		.style("z-index", 10)
		.style("visibility", "hidden")
		.text("Simple text");

		//y - axis
		d3.select("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("transform", "translate("+ margin.right + "," + margin.bottom + ")")
		.call(d3.axisLeft(ys).tickValues([0,100,200,300,400]).tickFormat(d3.format("~s")));

		// text label for the y axis
		d3.select("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("transform", "translate("+ margin.right + "," + margin.bottom + ")")		
		.append("text")
		.attr("transform", "rotate(-90)")
		.attr("y", 0 - margin.left)
		.attr("x",0 - yheight/2)
		.attr("dy", ".75em")
		.style("text-anchor", "middle")
		.style("font", "Arial")
		.style("font-size", "11px")
		.style("font-weight", "bold")
		.text("No of Jobs"); 		

	  	// x- axis
		d3.select("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("transform", "translate("+ margin.right + "," + (yheight + margin.bottom) + ")") //(50,450)
		.call(d3.axisBottom(xs))
		.selectAll("text")
		.attr("y", 0)
		.attr("x", 10)
		.attr("dy", ".35em")
		.attr("transform", "rotate(90)")
		.style("text-anchor", "start")
		.style("font", "Arial")
		.style("font-size", "10px")
		.style("font-weight", "bold");
	}
	</script>
	
  </body>

  
</html>
